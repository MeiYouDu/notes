==好久没有折腾 webpack 了，最近又遇到了个几个可以优化的细节==

# webpack 打包速度优化

## linter 相关

### Eslint-webpack–plugin

1. concurrency
2. lintDirtyModulesOnly（仅限于开发模式）

### styleLint

1. lintDirtyModulesOnly（仅限于开发模式）

# webpack 构建产物运行效率优化

## split chunk

```typescript
optimization: {
  runtimeChunk: true,
  providedExports: true,
  sideEffects: true,
  splitChunks: {
   chunks: "all", // 使用 all，对入口也执行拆包
   minSize: 20000,
   minRemainingSize: 0,
   minChunks: 1,
   maxSize: 244 * 1024,
   maxAsyncRequests: 30,
   maxInitialRequests: 30,
   enforceSizeThreshold: 50000,
   usedExports: true,
   cacheGroups: {
    defaultVendors: {
     name: "vendors",
     test: /[\\/]node_modules[\\/]/,
     priority: -10,
     reuseExistingChunk: true,
    },
    default: {
     name: "common",
     minChunks: 2,
     priority: -20,
     reuseExistingChunk: true,
    },
   },
  },
},
```

## 图片资源处理

压缩/优化图片（WebP、svg、image-webpack-loader 或构建前处理）。把大图切成多尺寸或延迟加载。

```typescript
rules: [
    {
      test: /\.(png|jpe?g|webp|gif)$/i,
      type: 'asset', // 根据大小自动 inline 或 resource
      parser: {
        dataUrlCondition: {
          maxSize: 10 * 1024 // 10kb 内联
        }
      },
      generator: {
        filename: 'assets/images/[name].[contenthash][ext]'
      },
      use: [
        {
          loader: 'image-webpack-loader',
          options: {
            mozjpeg: { progressive: true, quality: 75 },
            optipng: { enabled: true },
            pngquant: { quality: [0.65, 0.9], speed: 4 },
            webp: { quality: 75 }
          }
        }
      ]
    }
  ]
```

