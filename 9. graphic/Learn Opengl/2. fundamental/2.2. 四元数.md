# 万向节死锁（Gimbal Lock）

万向节死锁是欧拉角描述三维旋转时因旋转轴重合导致的自由度丢失现象。产生原因如下：

1. 通过三次连续绕不同轴的旋转（如X→Y→Z）描述三维旋转。当中间轴（如Y轴）旋转特定角度（如90度）时，原本独立的旋转轴会重合，导致后续旋转失去一个自由度例如：

   - 先绕Y轴旋转90度，此时新的X轴与原Z轴对齐，绕X轴的旋转等效于绕原Z轴的旋转
   - 这种叠加效应使三个旋转轴变为两个，无法完全控制所有旋转方向。

2. 数学上的矩阵退化旋转矩阵的连续乘法会因特定角度导致矩阵秩减少。例如，绕Y轴旋转90度的矩阵为：

   $\R_{y}(90^{\circ})=\begin{pmatrix}0&0&1\\0&1&0\\-1&0&0\end{pmatrix}$

   此时绕X和Z轴的旋转矩阵相乘后，某些行或列会相同，使两个轴的旋转效果重叠

# 为什么要用四元数

- 解决万向节死锁（Gimbal Lock）问题
- 仅需存储4个浮点数，相比矩阵更加轻量
- 四元数无论是求逆、串联等操作，相比矩阵更加高效

所以综合考虑，现在主流游戏或动画引擎都会以缩放向量+旋转四元数+平移向量的形式进行存储角色的运动数据。

# 四元数怎么想出来的

先引入下面几个概念

## 空间中的子空间

一般而言，空间（维度>2）都存在更低维的子空间，比如二维空间中一维子空间，也就是直线；三维空间中的一维子空间和二维子空间，也就是直线和面。当超过三维的概念我们就很难去想象是什么样子，但四维空间一定会存在三维子空间或二维子空间。我们这里会加一个前缀超（hyper）来形容这些空间，比如高维空间中的平面我们称为超平面。

## 空间和子空间的映射

我们将二维空间表示为(x,y)，当y=0时，其实可以看成是一维的，只不过它表示成(x,0)这种形式。推到四维，(w,x,y,z)，当w=0时，(0,x,y,z)就是一个三维子空间，这也是为什么我们可以用单位四元数对三维向量进行操作，==其实我们是将三维向量映射到四维的三维子空间（w=0，这种形式也成纯四元数），然后对其进行旋转，最终得到的向量结果依然是这个三维子空间中的，因而可以映射回三维空间。==

## 广义球

这里的球是广义上的。我们在二维平面上，广义球其实指代circle，三维空间上就是我们认知上的球，称为two-sphere，而四维空间中广义球其实是一个超球（hyper-sphere），又称为three-sphere。单位向量其实就是广义球上面的点，而单位四元数也就是three-sphere上面的点。

## 约束与特征向量

空间中的一点由x, y, z等参数来表示，一般来说参数的数量与维数相等，二维空间的点用{x, y}参数，四维空间的点用{x, y, z, w}参数。但是对于空间的点加以约束，则该会减少参数的数量，比如三维空间的点在某一单位球面上，原本三个参数{x, y, z}才能表达的点现在只需要两个参数{u, v}就可以表达。如果{u, v}是单位向量，也可以称{u, v}是{x, y, z}的特征向量。

# 复数



上述概念给了大家一个思路，四元数这样一个东西并不是一蹴而就的，从空间来说，它与我们熟知的低维空间本质上是没有区别的，或者说是有很大共性的。四元数的很多特性都是从低维拓展而来的，更具体的说是从复数这一概念拓展的。

> 作者：杨智为
> 链接：https://zhuanlan.zhihu.com/p/27471300
> 来源：知乎